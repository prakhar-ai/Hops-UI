{% extends "base.html" %}

{% block content %}

<script>
    $("a").eq(5).removeClass("active");
    $("a").eq(8).addClass("active");
    </script>
            <div id="render_me">
                <div id="table">
                <table class="ui teal table">
                    
                    <tbody id="show_data">
                        <tr>
                        <td><b>Name</b></td>
                        <td>Rahul Jain</td>
                        
                        </tr>
                        <tr>
                        <td><b>Age</b></td>
                        <td>21</td>
                        </tr>
                         <tr>
                        <td><b>Sex</b></td>
                        <td>Male</td>
                        
                        </tr>
                        <tr>
                        <td><b>Address</b></td>
                        <td>19 Narayan Chambers , 2nd Floor , Behind Patang Hotel , Ashram Road, Ahmedabad, Gujarat 380009</td>
                        </tr>
                        <tr>
                        <td><b>Result Type</b></td>
                        <td>Abnormal</td>
                        </tr>
                         <tr>
                        <td><b>Global Diagnosis</b></td>
                         <td>Mild</td>
                        </tr>
                    </tbody></table>
                </div>
                <div class="ui four column grid" style="margin-top:1%">
                    <div class="column">
                    <div class="ui segment">
                         <a class="ui violet ribbon label"  id="pop" data-html="<table class='ui violet table'><tbody><tr>
                        <td><b>Region1</b></td>
                        <td>70%</td>
                        </tr>
                        <tr>
                        <td><b>Region2</b></td>
                        <td>30%</td>
                        </tr></tbody></table>">Front</a>
                        <img class="ui medium image" id="front" src="">
                    </div>
                    </div>
                    <div class="column">
                    <div class="ui segment">
                        <a id="pop" class="ui violet ribbon label">Lateral</a>
                        <img class="ui medium image" id="lateral" src="">

                    </div>
                    </div>
                    <div class="column">
                    <div class="ui segment">
                        <a id="pop" class="ui violet ribbon label">Natural</a>
                        <img class="ui medium image" id="natural" src="">
                    </div>
                    </div>
                    <div class="column">
                        <div class="ui segment">
                        <a id="pop" class="ui violet ribbon label">Top</a>
                        <img class="ui medium image" id="top" src="">
                    </div>
                    </div>
                 </div>
<!--
            <div class="ui small images" style="margin:2em">

                    <img class="ui medium bordered image" src="front.png" style="height: 250px;  width: 250px;margin:0.5em">
                
                    <img class="ui medium bordered image" src="lateral.png" style="height: 250px;  width: 250px;margin:0.5em">

                    <img class="ui medium bordered image" src="top.png" style="height: 250px;  width: 250px;margin:0.5em">
 
                    <img class="ui medium bordered image" src="natural.png" style="height: 250px;  width: 250px;margin:0.5em">

                </div>-->
                
                  <div class="ui container" style="margin-top:1%">
                <a href="../getreport" target="_blank" class="ui green labeled icon button" id = "report-download"  style="margin:1%"><i class="file alternate icon" style="background-color: rgba(100, 31, 211, 0.089);"></i>Download Report</a>
                <a href="/vtkviewer">
                 <button class="ui blue primary labeled icon button" style="margin:1%">
                        <i class="x ray icon" style="background-color: rgba(100, 31, 211, 0.089);"></i>View VTK File
                     </button>
                     </a>
                  <button class="ui teal primary labeled icon button" style="margin:1%" type="submit">
                        <i class="images icon" style="background-color: rgba(100, 31, 211, 0.089);"></i>View 2D Images
                     </button>
                </div>

        <script>
            
            var data = JSON.parse("{{data|escapejs}}");
            var studyid = data['studyid'];
            var arr = data['list'];
            var len = arr.length;
            // $('#top').attr("src","data:image/png;base64,"+data['top']);
            // $('#lateral').attr("src", "data:image/png;base64,"+data['lateral']);
            // $('#natural').attr("src", "data:image/png;base64,"+data['natural']);
            // $('#front').attr("src", "data:image/png;base64,"+data['front']);
            $('#top').attr("src",studyid+"/"+arr[len-2]);
            $('#lateral').attr("src",studyid+"/"+arr[len-6]);
            $('#natural').attr("src",studyid+"/"+arr[len-5]);
            $('#front').attr("src",studyid+"/"+arr[len-8]);
            

            var obj = data['out'];
            console.log(obj);
            var crs = obj.co_rads_score;
            var ggo = obj.ggo_ratio;
            var left_i = obj.left_inferior_lobe_percentage_affected;
            var left_s = obj.left_superior_lobe_percentage_affected;
            var right_i = obj.right_inferior_lobe_percentage_affected;
            var right_m = obj.right_middle_lobe_percentage_affected;
            var right_s = obj.right_superior_lobe_percentage_affected;
            var no_ls = obj.num_of_lung_slices;
            var no_ls_p = obj.num_of_positive_slices;
            var ratio = obj.ratio_of_positive_slices;
            var result_type = obj.ResultType;
            var GlobalDiagnosis = obj.GlobalDiagnosis;
            var k=`<tr><td><b>Name</b></td><td>Rahul Jain</td></tr>
                        <tr>
                        <td><b>Age</b></td>
                        <td>21</td>
                        </tr>
                         <tr>
                        <td><b>Sex</b></td>
                        <td>Male</td>
                        </tr>
                        <tr>
                        <td><b>Address</b></td>
                        <td>19 Narayan Chambers , 2nd Floor , Behind Patang Hotel , Ashram Road, Ahmedabad, Gujarat 380009</td>
                        </tr>
                        <tr>
                        <td><b>Result Type</b></td>
                        <td>${result_type}</td>
                        </tr>
                         <tr>
                        <td><b>Global Diagnosis</b></td>
                         <td>${GlobalDiagnosis}</td>
                        </tr>
                        <tr>
                        <td><b>CO Rads Score</b></td>
                         <td>${crs}</td>
                        </tr>
                        <tr>
                        <td><b>GGO ratio</b></td>
                         <td>${ggo}</td>
                        </tr>
                        <tr>
                        <td><b>No of lung slices</b></td>
                         <td>${no_ls}</td>
                        </tr>
                        <tr>
                        <td><b>No of positive slices</b></td>
                         <td>${no_ls_p}</td>
                        </tr>
                        <tr>
                        <td><b>Ratio positive slices</b></td>
                         <td>${ratio} %</td>
                        </tr>`
            document.getElementById('show_data').innerHTML = k;

           // console.log(data);

        </script>
            
        <script src='https://parall.ax/parallax/js/jspdf.js'></script>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.8.1/html2pdf.bundle.min.js'></script>
        <script>
           /* var doc = new jsPDF();
            var specialElementHandlers = {
                '#editor': function(element, renderer){
                    return true;
                }
            };

            doc.fromHTML($('#render_me').get(0), 15, 15, {
                'width': 100, 
                'elementHandlers': specialElementHandlers
            });

            $('a').click(function(){
            doc.save('TestHTMLDoc.pdf');
            });
    
           var element = document.getElementById('render_me');

            html2pdf(element).set({
            margin: 1,
            filename: 'test.pdf',
            html2canvas: { scale: 2 },
            jsPDF: {orientation: 'portrait', unit: 'in', format: 'letter', compressPDF: false}
            }).save();*/
        </script>
		
		<script>
            $('#pop').popup({
            inline     : true,
            hoverable  : true,
            position   : 'top center',
            delay: {
            show: 100,
            hide: 400
            }
         });
     </script>
			
{% endblock content %}